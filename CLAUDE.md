# 專案記憶

## 專案概述
- 單頁式工程計算器（`index.html`），部署於 GitHub Pages
- GitHub 帳號：`jamesliou777`
- 儲存庫：`MyClaude`，分支：`main`
- 最新提交：`82d740f` - 修正離心力方位角符號慣例

## 架構
- **單一 HTML 檔案**，內嵌 CSS 與 JS
- 分頁導覽：beam、column、concrete、rebar、rcbeam、unit
- 頁首設有全域單位系統選擇器

## 單位系統
- 支援：kN-m、Kgf-cm、tf-m、N-mm、tf-cm、Kgf-m
- 架構：`factorsToSI`、`unitSystemDefs`、`fieldUnits`（含 `dim` 屬性）
- 函式：`switchUnitSystem()`、`resultInSystem()`
- RC 梁以 kgf/cm² 為應力基底，tf·m 為彎矩基底

## 功能

### RC 梁撓曲設計（ACI 318）
- Rn 法、β1、ρmin/ρmax、εt 應變檢核

### RC 柱斷面設計
- **斷面幾何**：預設形狀（矩形/圓形/T型/L型）含參數化輸入，或自訂頂點
- **空心區域**：無空心/空心矩形/空心圓形/自訂頂點
- **斷面預覽**：SVG 即時渲染，顯示外輪廓、空心、鋼筋、塑性中心標記、方位角箭頭
- **鋼筋配置**：自動排列（可設最小間距與單支面積）或手動編輯，支援自訂鋼筋（no=0）
- **保護層**：由 ic（保護層厚度）+ 箍筋直徑自動計算鋼筋中心至外緣距離
- **塑性中心**：以 0.85f'c·Ag 及鋼筋 fy 計算（扣除空心），顯示於 SVG
- **離心力方位角 α**：α = atan2(-Mux, Muy)，偏心距 ex=Muy/Pu, ey=-Mux/Pu
- **P-Mx-My 交互圖**：計算核心待實作

### 關鍵資料結構
- `rcColData`：`{ outer:[], hollow:[], rebars:[{x,y,no,area}], pcX, pcY, alpha }`
- `rebarInfo`：含 #3~#11 標準鋼筋，`0` 為自訂面積鋼筋
- `polyProps(pts)`：Shoelace 公式計算多邊形面積與重心

### 關鍵演算法
- 多邊形內縮偏移：邊法線向量 + 相鄰偏移線交點（非 centroid shrink）
- 自動排列鋼筋：沿內縮多邊形邊以指定間距放置

### RC 柱 HTML 區段順序
A.斷面幾何 → B.鋼筋配置 → C.斷面預覽 → D.材料參數 → E.載重條件 → F.設計參數

## 已移除區段
- 電機計算、邊坡穩定、管路水路

## 部署
- 從 main 分支部署至 GitHub Pages
- 需手動至 Settings → Pages 啟用（若尚未啟用）

## 待處理 / 暫緩
- P-Mx-My 交互圖計算核心（結果區顯示「⏳ 計算核心待提供」）
- 程式碼保護（混淆、WASM、後端 API）— 使用者暫緩，仍在考慮中
- GitHub Pages 手動啟用狀態未確認

## 提交歷史
- `bd9fb75` 初始提交：新增 index.html
- `2d16cae` 新增全域單位系統切換器
- `86d027b` 移除電機計算、邊坡穩定、管路水路區段
- `723f2c1` 新增 RC 梁撓曲設計計算器（ACI 318）
- `8b8375b` 新增 RC 柱斷面設計 UI（任意斷面幾何與 SVG 預覽）
- `ea8215f` 自動排列鋼筋：可設間距與面積
- `4fec8b0` 斷面預覽移至鋼筋配置之前
- `50329ba` 修正鋼筋偏移為真正多邊形邊法線內縮
- `ef821d9` 預設形狀參數化輸入（矩形B/H、圓形R、T型、L型）
- `12cdfd0` 空心區域選擇器（無/矩形/圓形/自訂）
- `3d849d2` 區段重新編號（預覽=B、鋼筋=C…）
- `261f492` 保護層拆分為 ic + 箍筋直徑
- `0f777a8` 塑性中心與離心力方位角計算
- `f712436` SVG 預覽顯示塑性中心與方位角箭頭
- `82d740f` 修正離心力方位角符號慣例（α=atan2(-Mux,Muy)）
